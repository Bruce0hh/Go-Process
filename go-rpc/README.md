# go rpc

> 该项目所有内容均摘自https://geektutu.com/

## 处理超时

### 客户端处理超时

1. 与服务端建立连接导致的超时
2. 发送请求到服务端，写报文导致的超时
3. 等待服务端处理，等待处理导致的超时
4. 从服务端接收响应，读报文导致的超时

### 服务端处理超时

1. 读取客户端的请求报文，读报文导致的超时
2. 发送相应报文，写报文导致的超时
3. 调用映射服务的方法，处理报文导致的超时

## 负载均衡&服务发现

> 负载均衡的前提是有多个服务实例

- 随机选择策略：随机选择一个
- 轮询算法：`i = (i + 1) mod n`
- 加权轮询：在轮询算法的基础上，对服务实例设置一个权重，具体指标可做动态调整
- 哈希/一致性哈希策略：依据请求的某些特征，计算一个hash值，根据hash值将请求发送到对应的机器

## 注册中心

1. 服务端启动后，向注册中心发送注册消息，注册中心得知该服务已经启动，处于可用状态。一般来说，服务端还需要定期向注册中心发送心跳，证明自己还活着。
2. 客户端向注册中心询问，当前那些服务是可用的，注册中心将可用的服务列表返回客户端。
3. 客户端根据注册中心得到的服务列表，选择其中一个发起调用。
